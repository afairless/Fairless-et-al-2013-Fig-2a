{
    "contents" : "# Andrew Fairless, September 2011\n# modified May 2015 for posting onto Github\n# This script constructs the boxplots for Figure 2a of Fairless et al 2013\n# Fairless et al 2013, doi: 10.1016/j.bbr.2012.08.051, PMID: 22982070, PMCID: PMC3554266\n\n# The fictional data in \"altereddata.txt\" were modified from the original \n# empirical data used in Fairless et al 2011.\n# I am using fictional data instead of the original data because I do not have \n# permission of my co-authors to release the data into the public domain.  \n# NOTE:  Because the data have been altered, many characteristics of the original \n# data set will not be retained.\n\ninstall.packages(\"psych\", dependencies = TRUE)    # install package if not already installed\ninstall.packages(\"gplots\", dependencies = TRUE)   # install package if not already installed\n\n\nlibrary(psych)     \t\ndatamaxmice = read.table(\"altereddata.txt\", header = TRUE)\t\t\ndata = datamaxmice\t\t\ndata[ ,(dim(data)[2] + 1)] = data$brainwt / data$mousewtadj\t\t\ncolnames(data)[dim(data)[2]] = \"brwtmswt\"\t     # adds variable:  ratio of brain weight to mouse weight\t\ndata[ ,(dim(data)[2] + 1)] = data$sniff + data$passivepawing\t\t\ncolnames(data)[dim(data)[2]] = \"allsocial\"\t\t# adds variable:  sum of all social behaviors\ndata = split(data, list(data$sex, data$age, data$strain))\t\t\n\n# determines which experimental groups (as defined by strain, sex, age) are included\n# numbered as elements in the list 'data'\n# elements 7 through 12 denote the C57BL/6J mouse groups\nexpgroups = 7:12\n\n# determines which experimental variables are included \n# numbered as columns of the data frames, which are elements of the list 'data'\n# columns 19, 22, and 37 specify \"na\", \"nonsocial\", and \"allsocial\" behaviors, respectively\nvarcols = c(37, 22, 19)\t\t\n\nmaxrow = 1\t\t\nfor (iter in expgroups) {\t\t\n     maxrow = max(maxrow, dim(data[[iter]])[1])\t\t\n}\t\t\nmaxrow = maxrow + 1\t\t\nfor (iter in expgroups) {\t\t\n     data[[iter]][(dim(data[[iter]])[1] + 1):maxrow, ] = NA\t\t\n     rownames(data[[iter]]) = 1:maxrow\t\t\n}\t\t\n\ndatagraph = 1:maxrow\t\t\ndatagraph = as.data.frame(datagraph)\t\t\ngraphcol = 0\t\t\n\nfor (iter in expgroups) {\t\t\n     for (iter2 in 1:length(varcols)) {\t\t\n          graphcol = graphcol + 1\t\t\n          datagraph[ ,graphcol] = data[[iter]][ ,varcols[iter2]]\t\t\n          colnames(datagraph)[graphcol] = paste(colnames(data[[iter]])[varcols[iter2]], \n                                                names(data)[iter], sep = \",\")\t\t\n     }\t\t\n}\t\t\n\n\nlibrary(gplots)\n\n# creates table with values (i.e., upper and lower box limits and the median) for the boxplot\ndatasumm = c(1, 1, 1)\ndatasumm = as.data.frame(datasumm)\nfor (iter in 1:dim(datagraph)[2]) {\n     datasumm[1, iter] = summary(datagraph[ ,iter])[[3]]\n     datasumm[2, iter] = summary(datagraph[ ,iter])[[2]]\n     datasumm[3, iter] = summary(datagraph[ ,iter])[[5]]\n}\nrownames(datasumm) = c(\"central\", \"lowerrbar\", \"upperrbar\")\ncolnames(datasumm) = colnames(datagraph)\ndatasumm = t(datasumm)\ndatasumm = (datasumm / 61) * 100\n\nlwd = 2\ncol = c(7, 5, 3)\nspace = c(3, 0, 0, 1, 0, 0)\n\n# \"nacol\" adds vertical empty spaces to separate the groups of boxes in the boxplot\nnacol = rep(x = NA, times = maxrow)     \ndatagraph = cbind(datagraph[ ,1:3], nacol, datagraph[ ,4:6], nacol, nacol, nacol, \n                  datagraph[ ,7:9], nacol, datagraph[ ,10:12], nacol, nacol, nacol, \n                  datagraph[ ,13:15], nacol, datagraph[ ,16:18])\t\n\npng(\"B6 soc nonsoc na boxplot space3.png\", width = 640, height = 512)\t\npar(mar = c(5.1, 4.1, 4.1, 4.1))\nboxplot((datagraph / 61) * 100, col = c(7, 5, 3, 1, 7, 5, 3, 1, 1, 1), \n        ylab = \"Portion (%) of all scored time points\", ylim = c(0, 80), \n        yaxt = \"n\", xaxt = \"n\", cex.lab = 1.5)\n# denotes the mean of each group with an asterisk (*)\npoints(mean((datagraph / 61) * 100, na.rm = T), pch = 8, col = 1)\n\naxis(2, at = seq(0, 80, by = 10), las = 2, lwd = lwd, cex.axis = 1.6)\n\n# x-axis\nsexverticaloffset = 1\nageverticaloffset = 2.5\nxlabelcex = 1.3\ntext(4, labels = \"30 days\", par(\"usr\")[3], pos = 1, xpd = T, cex = xlabelcex, offset = ageverticaloffset, font = 2)\ntext(14, labels = \"41 days\", par(\"usr\")[3], pos = 1, xpd = T, cex = xlabelcex, offset = ageverticaloffset, font = 2)\ntext(24, labels = \"69 days\", par(\"usr\")[3], pos = 1, xpd = T, cex = xlabelcex, offset = ageverticaloffset, font = 2)\ntext(c(2, 12, 22), labels = \"female\", par(\"usr\")[3], pos = 1, xpd = T, cex = xlabelcex, offset = sexverticaloffset, font = 2)\ntext(c(6, 16, 26), labels = \"male\", par(\"usr\")[3], pos = 1, xpd = T, cex = xlabelcex, offset = sexverticaloffset, font = 2)\n\n# legend\npar(font = 2)\nleg = col\nleg = as.data.frame(leg)\nleg[ ,2] = c(\"C57BL/6J social\", \"C57BL/6J nonsocial\", \"C57BL/6J no behavior\")\nlegend(0, 80, legend = leg[ ,2], fill = leg[ ,1], bty = \"o\")\npar(font = 1)\n\n# right-hand y-axis\ntkmks2 = seq(0, 50, by = 5)\naxis(4, at = tkmks2 / 0.61, las = 2, lwd = lwd, cex.axis = 1.6, labels = tkmks2)\npar(xpd = T) \ntext(31.3, 40, \"Number of time points\", cex = 1.5, srt = 270)\npar(xpd = F)\n\ndev.off()\t\n",
    "created" : 1431038981319.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1280537068",
    "id" : "F263D987",
    "lastKnownWriteTime" : 1431027643,
    "path" : "/media/zh/My Passport/backup/2015 code share/Fairless et al 2013 Fig 2a/to share/revising.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}